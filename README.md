# CVD-prediction-ensemble
An Analysis of Ensemble Learning (Random Forest, Balanced Bagging and Gradient Boosting) and Neural Networks (DNN) for Cardiovascular Disease (CVD) Risk Prediction 

Cardiovascular disease (CVD) is the leading chronic illness and primary cause of morbidity and mortality globally (Li et al., 2024). This stresses the need for strong predictive models to aid and enhance clinical decision-making systems. This analysis presents a systematic process to develop and evaluate machine learning models for CVD risk prediction using a real-world dataset, with an emphasis on clarity, reproducibility, and evidence-based procedures.
The dataset consists of medical information of more than 70,000 individuals with features including age, gender, height, weight, systolic and diastolic blood pressure (ap_hi, ap_lo), cholesterol, glucose, lifestyle factors (smoke, alco, active), and the CVD outcome(cardio).

A first assessment of the data revealed missing values and several biologically impossible entries (out-of-range ages, weight, blood pressure). Structured cleaning was done to identify and drop rows affected by missing values, and rational rules based on medical guidelines on age (30-65 years), systolic BP (90-240mmHg) (Li et al., 2024), were used to remove irrelevant values. A robust 68,147 records and 13 variables were left after cleaning.

Feature engineering was performed on several categorical features to ensure explainability. BMI was calculated and categorized as ‘Underweight’, ‘Healthy’, ‘Overweight’, and ‘Obese’, according to (Adult BMI categories, 2024). AGE was used to group patients into ‘Young adult’ (<= 50 years), and ‘Middle-aged’ (>50 years) per (Yao et al., 2012). Blood Pressure Category was created into groups ‘Non-hypertensive’, ‘Grade 1’, ‘Grade 2’, and ‘Grade 3’ hypertension using (Li et al., 2024). Cholesterol and Glucose were categorized according to normal, above normal, and well above normal, and a binary variable merged smoking, alcohol use, and inactivity into ‘non-healthy lifestyle’ (1 = unhealthy, 0 = healthy).

Exploratory Data Analysis (EDA) was conducted using histograms of important variables to confirm that there were no more outliers and to show realistic distributions. Stacked bar plots were employed to show the relationships between each of the engineered features ‘age_group’, ‘BMI_category’, ‘BP_category’, ‘gender_category’, ‘cholesterol_category’, ‘glucose_category’, ‘non_healthy_lifestyle’, and CVD outcome ‘cardio’. Visualization for ‘cardio’ showed a healthy class balance, ensuring unbiased model training without any need for class balancing techniques.

Two modeling approaches were used for comparison: feature-engineered modeling and basic modeling (using only cleaned, original features). Two ensembles (Random Forest Classifier (RFC) and Gradient Boosting Classifier (GBC), and evaluation metrics (ROC-AUC, Confusion matrix, classification report, and feature importance) were used for each approach. For feature-engineered modeling, categorical variables were dummy encoded to enable ensemble models to train well on them, whilst for basic modeling, Standard Scaler was used to scale the original features. Hyperparameter optimization was performed using GridSearchCV with nested cross-validation using StratifiedKFold to prevent data leakage and maintain class balance. ROC-AUC was used as the main evaluation metric as it reflects overall accuracy and model performance across thresholds (Bradley, 1997). For feature-engineered modeling, ROC-AUC for RFC and GBC were identical at approximately 0.77, while for basic modeling, ROC-AUC for RFC and GBC were also identical at approximately 0.80. These best results achieved with the basic approach show that the original features, after proper cleaning, were highly informative.

Feature importance visualization showed that Systolic (ap_hi) and Diastolic (ap_lo), age, cholesterol, and weight were the strongest predictors, aligning with established CVD risk literature (Li et al., 2024). The basic approach Random Forest model (basic_clf), which was chosen as the best model for this task, achieved an AUC of 0.82, indicating good discriminative ability. Threshold adjustment results showed that at threshold 0.4, recall for high-risk cases (CVD=1) was maximized at 0.78, minimizing missed diagnoses. At 0.6 threshold, precision for high-risk cases increased, but more true positives were missed. A threshold of 0.4 is recommended for patient risk stratification as it prioritizes patient safety and minimizes missed diagnoses. The good balance of recall for high-risk (0.78) and low-risk (0.69) is the best for this task.

These findings show that ensemble learning, especially Random Forest and Gradient Boosting, are strong tools for clinical risk prediction. The higher performance of basic modeling using only preprocessed data shows that with proper cleaning, original features are enough to generate accurate predictions. Feature engineering adds comprehensibility and clinical insight, which can be useful in certain scenarios. Threshold adjustment is essential as a lower threshold of 0.4 increases sensitivity and is good for preventive care, while a higher threshold of 0.6 is good for situations where false positives carry significant cost.

This methodology shows that proper data cleaning, systematic feature selection, robust cross-validation, and insightful evaluation are all important for reproducible and interpretable machine learning in healthcare.
This task successfully designed and implemented ensemble models for CVD risk prediction, achieving high ROC-AUC and balanced prediction performance for both high and low risk individuals.

References
Li, Q. et al. (2024) 'Re-evaluating cardiovascular risk in systolic-dominant, diastolic-dominant and parallelly-elevated hypertension: insights from northeast rural cardiovascular health study,' Scientific Reports, 14(1). https://doi.org/10.1038/s41598-024-79189-2.

Adult BMI categories (2024). https://www.cdc.gov/bmi/adult-calculator/bmi-categories.html.

World Health Organization: WHO (2021) Cardiovascular diseases (CVDs). https://www.who.int/news-room/fact-sheets/detail/cardiovascular-diseases-(cvds).

Yao, X.-Y. et al. (2012) 'Age- and Gender-Specific Prevalence of Risk Factors in Patients with First-Ever Ischemic Stroke in China,' Stroke Research and Treatment, 2012, pp. 1–6. https://doi.org/10.1155/2012/136398.

Bradley, A.P. (1997) 'The use of the area under the ROC curve in the evaluation of machine learning algorithms,' Pattern Recognition, 30(7), pp. 1145–1159. https://doi.org/10.1016/s0031-3203(96)00142-2.
